# Canvas

## Canvas的工作原理

1. Canvas是一个基于像素的位图画布，你可以通过Javascript API直接操作一个像素缓冲区，绘制图形、线条、图像等；
2. 为什么Canvas绘制会比传统的DOM渲染性能好？
  - 直接像素操作：绘制完成后，浏览器只需将整个画布作为一个单一的图像渲染到屏幕上。这避免了复杂的DOM树管理和元素级计算；
  - 无状态渲染：Canvas不维护图形元素的“状态”（如位图、样式变化）。每次更新时，你可以清空画布并重新绘制所有内容，这在高帧率动画中很高效，因为它不涉及Diff、增量更新DOM；
  - 硬件加速：现代浏览器会使用GPU加速Canvas2D/3D渲染，尤其是WebGL上下文，进一步提升性能；

3. 和其他的渲染技术对比（为什么“更好”）？
  - 对比DOM-based渲染（使用div、span等元素模拟图形）；
    - DOM渲染涉及构建和维护一个元素树，每次更新（如移动元素、改变样式）都会触发浏览器的重排和重绘过程，这很昂贵，因为浏览器需要重新计算布局、样式和渲染层；
    - 对于大量元素：DOM操作会造成性能瓶颈：JS到DOM的桥接开销大，垃圾回收频繁；
    - Canvas的优势：它绕过了DOM，只有一个canvas元素作为容器。测试显示，在渲染1000+移动对象时，Canvas的FPS往往高出DOM数倍（具体取决于硬件）；
  - 对比SVG；
    - SVG是基于向量的，图形作为DOM元素存在。它适合可缩放的静态图形，但更新时仍需操作DOM，导致类似的重排/重绘开销；
    - Canvas的优势：在动态场景中，SVG的向量计算（缩放、变换）更慢，而Canvas的位图像素渲染更快，尤其在低分辨率或固定大小画布上上。SVG在高分辨率设备上更清晰，但性能代价更高。
  - 对比WebGL（Canvas的3D扩展）：
    - WebGL实际上是基于Canvas的（使用getContext('wevgl')），它提供更低的API访问GPU，所以在3D渲染中性能更好。但纯2D Canvas比WebGL更简单、更轻量，不需要处理着色器等复杂性；

##   
